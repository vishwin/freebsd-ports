PORTNAME=	marisa-trie
DISTVERSIONPREFIX=	v
DISTVERSION=	0.3.1
PORTEPOCH=	1
CATEGORIES=	devel

MAINTAINER=	wen@FreeBSD.org
COMMENT=	MARISA: Matching Algorithm with Recursively Implemented StorAge
WWW=		https://github.com/s-yata/marisa-trie

LICENSE=	BSD2CLAUSE LGPL21+
LICENSE_COMB=	dual
LICENSE_FILE=	${WRKSRC}/COPYING.md

USES=		cmake pathfix
USE_GITHUB=	yes
GH_ACCOUNT=	s-yata
GH_PROJECT=	marisa-trie
USE_LDCONFIG=	yes

CMAKE_ARGS+=	-DBUILD_SHARED_LIBS=ON -DENABLE_NATIVE_CODE=ON
CMAKE_BOOL+=	ENABLE_NATIVE_CODE

OPTIONS_DEFINE=	SSE2 SSE3 SSSE3 SSE4 SSE41 SSE42 POPCNT BMI BMI2
OPTIONS_DEFAULT=${MACHINE_CPU:tu}

SSE2_DESC=	Support for SSE2
SSE2_CMAKE_ARGS=	-DENABLE_NATIVE_CODE=ON -DHAVE_SSE2=ON -DENABLE_SSE2=ON
SSE2_CMAKE_BOOL+=	HAVE_SSE2 ENABLE_SSE2

SSE3_DESC=	Support for SSE3
SSE3_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_SSE3=ON -DENABLE_SSE3=ON
SSE3_CMAKE_BOOL+=	HAVE_SSE3 ENABLE_SSE3

SSSE3_DESC=	Support for SSSE3
SSSE3_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_SSSE3=ON -DENABLE_SSSE3=ON
SSSE3_CMAKE_BOOL+=	HAVE_SSSE3 ENABLE_SSSE3

SSE4_DESC=	Support for SSE4
SSE4_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_SSE4=ON -DENABLE_SSE4=ON
SSE4_CMAKE_BOOL+=	HAVE_SSE4 ENABLE_SSE4

SSE41_DESC=	Support for SSE4.1
SSE41_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_SSE4_1=ON -DENABLE_SSE4_1=ON
SSE41_CMAKE_BOOL+=	HAVE_SSE4_1 ENABLE_SSE4_1

SSE42_DESC=	Support for SSE4.2
SSE42_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_SSE4_2=ON -DENABLE_SSE4_2=ON
SSE42_CMAKE_BOOL+=	HAVE_SSE4_2 ENABLE_SSE4_2

POPCNT_DESC=	Support for POPCNT
POPCNT_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_POPCNT=ON -DENABLE_POPCNT=ON
POPCNT_CMAKE_BOOL+=	HAVE_POPCNT ENABLE_POPCNT

BMI_DESC=	Support for BMI
BMI_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_BMI=ON -DENABLE_BMI=ON
BMI_CMAKE_BOOL+=	HAVE_BMI ENABLE_BMI

BMI2_DESC=	Support for BMI2
BMI2_CMAKE_ARGS+=	-DENABLE_NATIVE_CODE=ON -DHAVE_BMI2=ON -DENABLE_BMI2=ON
BMI2_CMAKE_BOOL+=	HAVE_BMI2 ENABLE_BMI2

.include <bsd.port.mk>
